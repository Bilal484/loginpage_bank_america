var cookieObj={};var header={toolbarDefault:function(){return false}};var globalFooter={footerDefault:function(){return false}};var globalObj={env:"",olbenv:"",deviceid:"device",servicegroupid:"",uniq_session_id:"",SMIdentity:"",ClientAIT:"41339",appDir:"",appPath:"",pageID:"page",allowRefresh:false,linkReferrer:"",location:"",locationPath:"",dc:"",isNative:false,isWebView:false,allowScrolling:true,viewport:"",onlineId:"",clientIPAddress:"",isIphone:"",isKindle:"",isAndroid:"",isIpad:"",isWindows:"",deviceType:"",iPadLegacy:false,isHighRes:false,isTouch:false,accountList:"null",safePassEnabled:false,safePassDevices:[],moduleParameters:"null",isTablet:false,CSessionID:"",appplicationError:"",cmsContent:"null",chickenSwitches:"",nativeAppDFP:"",deviceToken:"",ECDContentId:"",SAContentId:"",vipaaSession:[],SKLEmailId:"",timeOut:"",nativeTimeOut:0,enablePing:false,isPingFailed:false,pingTimer:2,currentEnv:"",language:"english",slideMenu:false,slideMenuVisible:false,menuNav:"",menuItem:"",isUserAuthenticated:false,enableCoreMetrics:false,mdaSessionId:"",transitionEffect:"slideInTrans",enableScrollToTop:false,accountsJson:"",consolidatedTransfers:"",getP2pAlias:"",smToken:"",isNativeServices:"",footerAuth:"",footerUnauth:"",footnote:"",webkitVersion:"",innerHeight:"",screenHeight:"",screenWidth:"",pageHeight:"",pageWidth:"",toggleCalled:false,expiredCookie:false,holidayList:null,cardreplace:"",eligibleAccountsOCC:"",eligibleAccountsOCD:"",akamaiPodType:"",eCLORedirectLandingPage:"",eCLORedirectCreditCardPage:"",newPasscodeStandardsSwitch:"",brainRedirecturl:"",languagePreference:"en-US"};var applicationObj={};var pageObj={currentPage:"",nextPage:"",prevPage:"",backPage:"",currentHash:"",cache:"",loginFlag:false,touchEvent:false,noLoadFlag:false,noLoadFlagTrigger:0,pageModel:{innerHeight:""},pageName:"",sasiflag:true,casRedirectionFlag:true,element:"#page"};var serviceObj={requestType:"POST",contentType:"application/xml; charset=utf-8",transport:"",endpoint:"",async:true,cache:false,dataType:"xml",retries:0};var jsonServiceObj={requestType:"POST",dataType:"json",contentType:"application/json; charset=UTF-8",endpoint:"",cache:false,async:true,server:"",retries:0};var jsonHeaderObj={"Content-Type":"application/json; charset=UTF-8","Cache-Control":"no-cache,no-store,must-revalidate",Pragma:"no-cache",Expires:"-1","x-crt-app-info":"MobileWeb MobileBanking "+getDeviceType(),"x-crt-app-version":"6.0","device-Id":"ipAddress=&fsoToken=&browserString="+navigator.userAgent+"&cookieToken=","device-type":"MobileWeb",isEmailValidityRequired:true,ClientAIT:globalObj.ClientAIT,SMIDENTITY:globalObj.SMIdentity,uniq_session_id:globalObj.uniq_session_id,isDfpEnabled:"",headerUserAgent:"",deviceFingerPrintInfo:"",hfyt:"",jxsf:"","Cache-Control":"no-cache",CConnType:"",CView:"",CRequestID:"","X-bofa-csl":"TRUE",CallLog:"",ModuleName:"",SafePassCapable:"",wurflDevice:"devi","x-Akamai-Pod":getAkamaiPodType(),gatewayCSRFToken:""};var headerObj={"Cache-Control":"no-cache,no-store,must-revalidate",Pragma:"no-cache",Expires:"-1","x-crt-app-info":"MobileWeb MobileBanking "+getDeviceType(),"x-crt-app-version":"5","device-Id":"ipAddress=&fsoToken=&browserString="+navigator.userAgent+"&cookieToken=","device-type":"MobileWeb",isEmailValidityRequired:true,ClientAIT:globalObj.ClientAIT,SMIDENTITY:globalObj.SMIdentity,uniq_session_id:globalObj.uniq_session_id,isDfpEnabled:"",headerUserAgent:"",deviceFingerPrintInfo:"",hfyt:"",jxsf:"","Cache-Control":"no-cache",CConnType:"",CView:"",CRequestID:"","X-bofa-csl":"TRUE",CallLog:"",ModuleName:"",SafePassCapable:"","x-Akamai-Pod":getAkamaiPodType(),gatewayCSRFToken:""};var businessEventObj={businessEvent:{code:"",description:"",statusCode:"",reasonCode:""}};var loggingObj={logLevel:0,logText:"",appText:"",pageText:"",serviceText:""};var visitedPages=[];var visitedPageFlag=[];var visitedPageCount=0;var qsObj={};var pageLoad="";var pageHistory=[];var hashChange=true;var prevHash="";var unloadText="You will lose your information.";var footer="";var toolbar="";var retries=0;var mobileweb={setEnvironment:function(){setApplicationObj();mobileweb.getPageTransitions();if(globalObj.deviceType===""){setDeviceType()}var c=document.referrer;if(top.location!==window.location){top.location=window.location}if(c.indexOf(".bankofamerica.com")>-1){globalObj.linkReferrer="Mobile Web"}else{if(c===""){globalObj.linkReferrer="Browser"}else{globalObj.linkReferrer="Unknown"}}var b;var a=(encodeURI(location.hash)).split("?");if(a[1]){b=a[1];qsObj=setObj("qsObj",b,"&","=")}if(qsObj.hasOwnProperty("pipeline")){globalObj.currentEnv="-"+qsObj.pipeline}globalObj.isWebView=document.URL.indexOf("file:")!==-1;if(!globalObj.isWebView){$.ajax({url:"config/mobileconfig"+globalObj.currentEnv+".js",dataType:"script",cache:true}).done(function(d){$.ajax({url:"js/mobileconfig-all.js",dataType:"script",cache:true}).done(function(e){mobileweb.configCallback(e);mobileweb=null}).fail(function(){console.log("mobileweb config load failed");alert("Could not find config/mobileconfig-all.js file")})}).fail(function(){console.log("mobileweb config load failed");alert("Could not find config/mobileconfig"+globalObj.currentEnv+".js file")})}if(window.devicePixelRatio>=2){globalObj.isHighRes=true}if(Math.max(document.height,document.width)/window.devicePixelRatio>=1000){globalObj.isTablet=true}globalObj.CSessionID=generateUUID();if(globalObj.enablePing===true){setPing()}if(globalObj.enableCoreMetrics===true){cmSetDD()}},configCallback:function(a){globalObj.location=mobilewebconfig.location;globalObj.locationPath=mobilewebconfig.locationPath;globalObj.env=mobilewebconfig.env;globalObj.akamaiPodType=mobilewebconfig.akamaiPodType;globalObj.brainRedirecturl=mobilewebconfig.eCLOOAALobImage;headerObj["x-Akamai-Pod"]=globalObj.akamaiPodType;jsonHeaderObj["x-Akamai-Pod"]=globalObj.akamaiPodType;globalObj.spartaRedirectionURI=mobilewebconfig.spartaRedirectionURI;setCSS();if(typeof mobilewebconfig.toolbar==="object"){mobileweb.getToolbar(mobilewebconfig.toolbar)}if(typeof mobilewebconfig.listview==="object"){mobileweb.getListView(mobilewebconfig.listview)}if(mobilewebconfig.appConfig!==""){$.each(mobilewebconfig.appConfig,function(b,c){applicationObj[b]=c});if(qsObj.pipeline){mobilewebconfig.appConfig.unloadPage=mobilewebconfig.appConfig.unloadPage+"&pipeline="+qsObj.pipeline}}if(typeof mobilewebconfig.template==="object"){mobileweb.getTemplate(mobilewebconfig.template.name)}if(typeof TeaLeaf!=="undefined"){TeaLeaf.Configuration.tlsecureurl=mobilewebconfig.tealeafurl}setViewPort();if(document.URL.split("#")[1]){loadPages(location.hash)}},getTemplate:function(a){$.ajax({url:"js/libs/"+a,dataType:"script",cache:true}).done(function(){}).fail(function(){console.log("template load failed");alert("Could not load template file "+a)})},getToolbar:function(a){loadModule(a)},getListView:function(a){loadModule(a)},getPageTransitions:function(){$.ajax({url:"js/transition.js",cache:true}).fail(function(){console.log("Unable to transition pages")})},setHashChange:function(){if("onhashchange" in window){$(window).on("hashchange",function(){if(hashChange){loadPages(location.hash)}else{hashChange=true}})}else{window.setInterval(function(){if(hashChange===false){prevHash=location.hash;hashChange=true}if(prevHash!=location.hash){prevHash=location.hash;loadPages(location.hash)}},500)}}};$(document).ready(function(){mobileweb.setEnvironment();var a=navigator.userAgent.toLowerCase();$(document).on("touchstart","body",function(b){pageObj.touchEvent=true});if(a.match(/msie/)){document.body.attachEvent("touchmove",noScroll);document.body.attachEvent("scroll",noScroll);window.attachEvent("pageshow",function(){checkWebTimeout()})}else{document.body.addEventListener("touchmove",noScroll,false);document.body.addEventListener("scroll",noScroll,false);window.addEventListener("pageshow",function(){checkWebTimeout()},false)}$(window).on("orientationchange",function(){if(!globalObj.slideMenuVisible&&globalObj.slideMenu&&typeof slidemenuObj==="object"){slidemenuObj.hideSlideOverMenu()}$("div input").trigger("blur");$("#"+globalObj.pageID).animate({width:"100%",position:"static"},200);$("#btnPin").css({position:"fixed",bottom:"0px",left:"0px"});resizePopups();setTimeout(header.maxWidth,500)});$(window).on("beforeunload",function(){document.cookie="app="+globalObj.appDir;if(!globalObj.allowRefresh){return unloadText+" Do you want to continue?"}});jQuery.support.cors=true;mobileweb.setHashChange()});function setViewPort(){globalObj.viewport=document.querySelector("meta[name=viewport]");if((globalObj.isIphone||globalObj.isIpad)&&(globalObj.isNative||globalObj.isWebView)){globalObj.viewport.setAttribute("content","width=device-width; initial-scale=1.0; maximum-scale=1.0")}else{globalObj.viewport.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no")}}function setCSS(a){if(a===undefined||a===""){a=mobilewebconfig.cssFile}$("head").append('<link rel="stylesheet" href="css/'+a+'">')}function loadCMScripts(b){var c="https://www.bankofamerica.com/pa/global-assets/external/coremetrics/hp/eluminate.js";var a="https://www.bankofamerica.com/pa/global-assets/external/coremetrics/hp/cmdatatagutils.js";$.ajaxSetup({cache:true});$.when($.getScript(c),$.getScript(a),$.Deferred(function(d){$(d.resolve)})).done(function(){b()});$.ajaxSetup({cache:false})}function loadPages(b){if(globalObj.isIpad||globalObj.isIphone||globalObj.isAndroid||globalObj.isKindle){b=pageBackClickHandler(b)}if(!b){return false}if(globalObj.isUserAuthenticated&&b.indexOf("signOn")>0||pageObj.noLoadFlag){pageObj.noLoadFlag=false;return false}if(b.indexOf("#")>-1){b=b.substring(1)}if(b==="back"){pageHistory.pop();b=pageHistory[pageHistory.length-1];if(b===undefined){return false}hashChange=false;window.location.hash=b}else{if(b===""||b===null||b==="null"){return false}}showLoading();pageHistory.push(b);var a=(encodeURI(b)).split("?");b=a[0];qsObj={};if(a[1]){qsObj=setObj("qsObj",a[1],"&","=")}loadSpartaPages();if(applicationObj.isSpartaRedirect){window.location.href=applicationObj.spartaRedirectUrl}else{if(qsObj.hasOwnProperty("app")||globalObj.appDir===""){if(qsObj.hasOwnProperty("app")){globalObj.appDir=qsObj.app;globalObj.appPath="../"+globalObj.appDir;setCookie("app",globalObj.appDir,1)}else{globalObj.appDir=getCookie("app");globalObj.appPath="../"+globalObj.appDir}if(qsObj.hasOwnProperty("dc")){globalObj.dc="-"+qsObj.dc}spartaBondFlag();if(applicationObj.spartaBond){switch(qsObj.app){case"transfers":pageObj.touchEvent=true;window.location.href="https://secure-dev4.ecnp.bankofamerica.com/move-money/transfers/between-my-accounts/";break;default:loadAppFile(b)}}else{loadAppFile(b)}}else{if(isHybrid(b)){loadBUSFile(b)}else{loadPageFiles(b)}}}applicationObj.coreMetricsConfig={CMPageIDVal:"",CMCatIDVal:""};return true}function pageBackClickHandler(a){if(!pageObj.touchEvent){if($("#slidemenu_sidePanel").css("left")==="0px"){slidemenuObj.hideSlideOverMenu()}if(pageObj.backPage!==""){if(typeof window.history.pushState==="function"){window.history.pushState({},"title",pageObj.backPage)}if(pageObj.backPage===pageObj.currentHash){return false}a=pageObj.backPage;hashChange=false;window.location.hash=a}}if(a.indexOf("?app=")>=1){pageObj.backPage=a}pageObj.currentHash=a;pageObj.touchEvent=false;return a}function loadAppFile(c){if(globalObj.appDir==="signon"){redirectSignon(c,"signonv2");return}else{if(globalObj.appDir==="enrollments"){redirectSignon(c,"enrollmentsv2");return}}var a=globalObj.appDir.split("/");a=a[a.length-1];var b=$.ajax({url:globalObj.appPath+"/js/"+a+".js"+addAuthHubNonCacheDirective(),dataType:"script",cache:true}).done(function(d){if(createAppVars!==undefined&&typeof createAppVars==="function"){toolbar="";footer="";if(loggingObj.logLevel>0){console.log("Running App script "+globalObj.appPath+"/js/"+a+".js");loggingObj.appText="Running App script "+globalObj.appPath+"/js/"+a+".js"}createAppVars();if(loggingObj.logLevel>1){console.log("ApplicationObj after "+globalObj.appPath+"/js/"+a+".js execution: "+getObj(applicationObj,",","=")+"\nHeaderObj = "+getObj(headerObj,",","="));loggingObj.appText+="ApplicationObj after "+globalObj.appPath+"/js/"+a+".js execution: "+getObj(applicationObj,",","=")+"\nHeaderObj = "+getObj(headerObj,",","=")}}if(isHybrid(c)){loadBUSFile(c)}else{loadPageFiles(c)}});b.fail(function(d,e){console.log("Page not found = "+globalObj.appPath+"/js/"+globalObj.appDir+".js status = "+e);loggingObj.logText="Page not found = "+globalObj.appPath+"/js/"+globalObj.appDir+".js status = "+e})}function isHybrid(b){var a=false;$.each(mobilewebconfig.loadBiz,function(c,d){if(globalObj.appDir===d.app){if(d.page===undefined){a=true;return false}else{$.each(d.page,function(f,e){if(b===e){a=true;return false}})}}});return a}function addAuthHubNonCacheDirective(){var a=false;var b="";if(typeof mobilewebconfig.AHstaticAssetLoad==="undefined"){return""}$.each(mobilewebconfig.AHstaticAssetLoad,function(c,d){if(globalObj.appDir===d.app){b="?ts="+mobilewebconfig.AssetLoadTimeStamp;return false}});return b}function loadBUSFile(a){$.ajax({url:globalObj.appPath+"/js/"+a+"-Biz.js"+addAuthHubNonCacheDirective(),dataType:"script",cache:true}).done(function(b){loadPageFiles(a)}).fail(function(b,c){console.log("Page not found = "+globalObj.appPath+"/js/"+a+"-Biz.js")})}function loadPageFiles(a){if(globalObj.appDir.indexOf("enrollments")>=0){redirectSignon(a,"enrollmentsv2")}else{loadPageFilesHelper(a)}}function redirectSignon(b,a){if(globalObj.appDir!==a){pageObj.touchEvent=true;document.location.hash=document.location.hash.replace(globalObj.appDir,a)}else{loadPageFilesHelper(b)}}function loadPageFilesHelper(b){var a="";if(typeof initTemplate==="function"){initTemplate=""}$.ajax({url:globalObj.appPath+"/js/"+b+".js"+addAuthHubNonCacheDirective(),dataType:"script",cache:true,complete:function(){var c=$.ajax({type:"GET",cache:true,url:globalObj.appPath+"/html/"+b+".html"+addAuthHubNonCacheDirective(),dataType:"html"}).done(function(h){hideLoading();var d=globalObj.pageID;pageObj.currentPage=b;h='<div id="SASI_banner_container"></div><div class="pageMinHeight">'+h+"</div>";transitionModule.normalPageTransition(h,globalObj.transitionEffect);if(loggingObj.logLevel>0){console.log("Page change to "+globalObj.appPath+"/html/"+b+".html GlobalObj = "+getObj(globalObj,",","="));loggingObj.pageText="Page change to "+globalObj.appPath+"/html/"+b+".html GlobalObj = "+getObj(globalObj,",","=")}if(typeof pageLoad==="function"){pageLoad(a);showSplash();if(globalObj.isUserAuthenticated&&isSet(globalObj.moduleParameters)){let ravenPilot=isRavenPilotEligible();if(ravenPilot){enablePayAndTransfer()}else{enablePaymentsAndInvoicing()}}var j=false;if(globalObj.isUserAuthenticated&&typeof applicationObj.signOnResponse!="undefined"&&typeof applicationObj.signOnResponse.payload.customer==="object"&&applicationObj.signOnResponse.payload.customer&&applicationObj.signOnResponse.payload.customer.indicatorProfile&&applicationObj.signOnResponse.payload.customer.indicatorProfile.familyBankingYouthFlag){j=true}if(j){var g=document.querySelectorAll(".popoverMenu li");for(var e=0;e<g.length;e++){var f=g[e];if(f.classList.contains("billpay")||f.classList.contains("billdotcom")||f.classList.contains("payAndTransfer")||f.classList.contains("bamd")||f.classList.contains("transfers")){f.style.display="none"}}}if(loggingObj.logLevel>1){console.log("ApplicationObj after "+globalObj.appPath+"/js/"+b+".js execution: "+getObj(applicationObj,",","=")+"\nHeaderObj = "+getObj(headerObj,",","="));loggingObj.pageText+="ApplicationObj after "+globalObj.appPath+"/js/"+b+".js execution: "+getObj(applicationObj,",","=")+"\nHeaderObj = "+getObj(headerObj,",","=")}if(loggingObj.logLevel>2){console.log("PageObj after "+globalObj.appPath+"/js/"+b+".js execution: "+getObj(pageObj,",","="));loggingObj.pageText+="PageObj after "+globalObj.appPath+"/js/"+b+".js execution: "+getObj(pageObj,",","=")}}if(globalObj.enableScrollToTop){window.scrollTo(0,1)}else{}if($("#popup").is(":visible")||$("#loading").is(":visible")){resizePopups()}setSlideOverMenuEvent("#slidemenuz");if(globalObj.enableCoreMetrics){setTimeout(function(){if(applicationObj.coreMetricsConfig.CMPageIDVal!==""&&applicationObj.coreMetricsConfig.CMCatIDVal!==""){if(typeof cX==="function"&&globalObj.enableCoreMetrics===true){cX("onload");trackCMEvents()}}else{if(typeof cX!="function"){alert("Error loading Coremetrics scripts")}}},500)}});c.fail(function(d,e){console.log("Page not found = "+globalObj.appPath+"/html/"+pageObj.currentPage+".html");loggingObj.logText+="Page not found = "+globalObj.appPath+"/html/"+pageObj.currentPage+".html";if(e==="timeout"||d.status===0){networkUnavailable()}})}})}function transitionTimeout(c,b,a){$("#"+a).show();$("#"+a).addClass(c);$("#oldPage").addClass(b);if(c==="slideInTrans"||c==="slideOutTrans"){setTimeout(function(){$("#oldPage").remove();$("#"+a).removeClass(c);$("#"+a).css({position:"static",height:"100%"});$("#btnPin").css({position:"fixed",bottom:"0px"})},400)}else{if(c==="slideUpTrans"||c==="slideDownTrans"){setTimeout(function(){$("#oldPage").remove();$("#"+a).removeClass(c);$("#"+a).css({position:"static",top:"0px",height:"100%"});$("#btnPin").css({position:"fixed",bottom:"0px"})},400)}else{$("#oldPage").remove();$("#"+a).css({position:"static",top:"0px",height:"100%"});$("#btnPin").css({position:"fixed",bottom:"0px"})}}}function trackCMEvents(){if(applicationObj.coreMetricsConfig){cmCreatePageviewTag(applicationObj.coreMetricsConfig.CMPageIDVal,null,null,applicationObj.coreMetricsConfig.CMCatIDVal,false,false,null,false,false,null,null,null,null,null,null,null,null,null,null,null,null)}}function addCMTags(a,b){applicationObj.coreMetricsConfig={CMPageIDVal:a,CMCatIDVal:b}}function fCall(d){var c=d.data[1](d);var b=window;var a=window;var e=d.data[0].split(".");$.each(e,function(f,g){a=b;b=b[g]});b.apply(a,c)}function makeGetRequest(b,d,a){resetTimeout();var c;if(loggingObj.logLevel>0){console.log("Get request endpoint: "+b+"\n");loggingObj.serviceText="Get request endpoint: "+b+"\n"}if(loggingObj.logLevel>1){console.log("GlobalObj: "+getObj(globalObj,",","="));loggingObj.serviceText+="GlobalObj: "+getObj(globalObj,",","=")}if(a===undefined){a=true}$.ajax({type:"GET",cache:a,url:b,success:function(f,g,e){c=f;globalObj.nativeTimeOut=new Date().getTime()},error:function(g,f,e){c=false;if(g.status==401||g.status==404||g.status==405||g.status==406||g.status==410||g.status==412||g.status==415||g.status==417||g.status==503||g.status==504){if(mobilewebconfig.errorPath!==undefined&&mobilewebconfig.errorPath!==""){pageObj.touchEvent=true;window.location.hash=mobilewebconfig.errorPath}}},complete:function(e,f){if(loggingObj.logLevel>0){console.log("Response from "+b+": "+getStringXML(c));loggingObj.serviceText+="Response from "+b+": "+getStringXML(c)}if(c===false&&e.responseText!==undefined){c=e.responseText;if(c.indexOf("<")!==-1&&c.lastIndexOf("<html>",0)!==0){c.substring(c.indexOf("<"));c=$.parseXML(c)}else{c=false}}if(d!==undefined&&typeof d==="function"){retries=0;c=d(c)}}});return c}function makeServiceRequest(k,a,n,g){resetTimeout();if(globalObj.isNativeServices){var d="\\|";var h="^";var e=getObj(headerObj,d,h);var j=n===undefined?"undefined":n.name;var i=g===undefined?JSON.stringify(serviceObj):JSON.stringify(g);var c=a===undefined?"":a;window.nativeServiceRequest.makeRequest(k,a,j,i,e,d,h);return false}var f;var m;var b;var o;var l={};if(globalObj.isPingFailed===true){alert("Please check your network connection");hideLoading();return false}if(typeof g==="undefined"){g={};g.requestType=serviceObj.requestType;g.contentType=serviceObj.contentType;g.transport=serviceObj.transport;g.endpoint=serviceObj.endpoint;g.async=serviceObj.async;g.cache=serviceObj.cache;g.retries=serviceObj.retries;g.dataType=serviceObj.dataType}l=sanitizeXmlDataReq(a);if(l===true){}else{n(false);return false}if(loggingObj.logLevel>0){console.log("Endpoint: "+k+"\nPayload: "+a+"\nRequest: "+getObj(g,",","=")+"\nCookies: "+document.cookie+"\nHeaderObj: "+getObj(headerObj,",","="));serviceText="Endpoint: "+k+"\nPayload: "+a+"\nRequest: "+getObj(g,",","=")+"\nCookies: "+document.cookie+"\nHeaderObj: "+getObj(headerObj,",","=")}if(loggingObj.logLevel>1){console.log("GlobalObj: "+getObj(globalObj,",","="));serviceText+="GlobalObj: "+getObj(globalObj,",","=")}$.ajax({type:g.requestType,contentType:g.contentType,xhrFields:{withCredentials:true},async:g.async,cache:g.cache,headers:headerObj,dataType:g.dataType,beforeSend:function(p){var q=navigator.userAgent.toLowerCase();if(q.match(/msie/)){f=msieISOString()}else{f=new Date().toISOString()}headerObj.CView=pageObj.currentPage},url:k,data:a,success:function(r,s,p){globalObj.clientIPAddress=p.getResponseHeader("X-Client-IP");if(p.getResponseHeader("SMIDENTITY")!==null&&p.getResponseHeader("SMIDENTITY")!==""){headerObj.SMIDENTITY=p.getResponseHeader("SMIDENTITY")}if(p.getResponseHeader("uniq_session_id")!==null&&p.getResponseHeader("uniq_session_id")!==""){headerObj.uniq_session_id=p.getResponseHeader("uniq_session_id")}if(p.getResponseHeader("isDfpEnabled")!==null&&p.getResponseHeader("isDfpEnabled")!==""){headerObj.isDfpEnabled=p.getResponseHeader("isDfpEnabled")}if(p.getResponseHeader("headerUserAgent")!==null&&p.getResponseHeader("headerUserAgent")!==""){headerObj.headerUserAgent=p.getResponseHeader("headerUserAgent")}if(p.getResponseHeader("deviceFingerPrintInfo")!==null&&p.getResponseHeader("deviceFingerPrintInfo")!==""){headerObj.deviceFingerPrintInfo=p.getResponseHeader("deviceFingerPrintInfo")}if(p.getResponseHeader("hfyt")!==null&&p.getResponseHeader("hfyt")!==""){headerObj.hfyt=p.getResponseHeader("hfyt")}if(p.getResponseHeader("jxsf")!==null&&p.getResponseHeader("jxsf")!==""){headerObj.jxsf=p.getResponseHeader("jxsf")}if(p.getResponseHeader("ClientLog")!==null&&p.getResponseHeader("ClientLog")!==""){b=p.getResponseHeader("ClientLog")}if(p.getResponseHeader("ServerID")!==null&&p.getResponseHeader("ServerID")!==""){m=p.getResponseHeader("ServerID")}if(globalObj.isAndroid){var q=p.getResponseHeader("Set-Cookie");extractCookiesFromResponse(q)}globalObj.isPingFailed=false;o=(r);globalObj.nativeTimeOut=new Date().getTime()},error:function(r,q,p){console.log("Call "+k+" failed: rep = "+r.statusText+" ; ex = "+q+"; o = "+p);hideLoading();if(r.status===401||r.status===404||r.status===405||r.status===406||r.status===410||r.status===412||r.status===415||r.status===417||r.status===500||r.status===503||r.status===504){if(mobilewebconfig.errorPath!==undefined&&mobilewebconfig.errorPath!==""){window.location.hash=mobilewebconfig.errorPath}return false}o=false;if(r.statusText==="OK"){globalObj.isPingFailed=false;o=""}if(q==="timeout"||r.status===0){networkUnavailable()}},complete:function(p,r){if(p.getResponseHeader("gatewayCSRFToken")!==null&&p.getResponseHeader("gatewayCSRFToken")!==""){var q=p.getResponseHeader("gatewayCSRFToken");if(q!==""&&q!==undefined){headerObj.gatewayCSRFToken=q}}if(headerObj.CRequestID===""||headerObj.CRequestID===undefined){headerObj.CRequestID=generateCLRequestID()}callbackService(p,f,m,b,a,r);if(loggingObj.logLevel>0){console.log("Response from "+k+": "+getStringXML(o));loggingObj.serviceText+="Response from "+k+": "+getStringXML(o)}if(o===false&&p.responseText!==undefined){o=p.responseText;if(o.indexOf("<")!==-1&&o.lastIndexOf("<html>",0)!==0){o.substring(o.indexOf("<"));o=$.parseXML(o)}else{o=false}}if(n!==undefined&&typeof n==="function"){retries=0;o=n(o)}}});return o}function makeServiceCall(a,b,e,d){var c="";if(typeof d=="undefined"){var d={};d.requestType=jsonServiceObj.requestType;d.endpoint=jsonServiceObj.endpoint;d.cache=jsonServiceObj.cache;d.retries=jsonServiceObj.retries;d.dataType=jsonServiceObj.dataType;d.async=jsonServiceObj.async;d.contentType=jsonServiceObj.contentType}if(loggingObj.logLevel>0){console.log("Endpoint: "+a+"\nPayload: "+b+"\nRequest: "+getObj(d,",","=")+"\nCookies: "+document.cookie+"\nHeaderObj: "+getObj(jsonHeaderObj,",","="));serviceText="Endpoint: "+a+"\nPayload: "+b+"\nRequest: "+getObj(d,",","=")+"\nCookies: "+document.cookie+"\nHeaderObj: "+getObj(jsonHeaderObj,",","=")}if(loggingObj.logLevel>1){console.log("GlobalObj: "+getObj(globalObj,",","="));serviceText+="GlobalObj: "+getObj(globalObj,",","=")}$.ajax({type:d.requestType,contentType:d.contentType,xhrFields:{withCredentials:true},cache:d.cache,headers:jsonHeaderObj,async:d.async,dataType:d.dataType,beforeSend:function(f){},url:a,data:b,success:function(f,h,g){c=f},error:function(h,g,f){c=false;if(h.status==401||h.status==404||h.status==405||h.status==406||h.status==410||h.status==412||h.status==415||h.status==417||h.status==503||h.status==504){if(mobilewebconfig.errorPath!==undefined&&mobilewebconfig.errorPath!==""){pageObj.touchEvent=true;window.location.hash=mobilewebconfig.errorPath}}},complete:function(g,i){if(loggingObj.logLevel>0&&typeof c==="object"){console.log("Response from "+a+": "+JSON.stringify(c));loggingObj.serviceText+="Response from "+a+": "+JSON.stringify(c)}if(g.getResponseHeader("gatewayCSRFToken")!==null&&g.getResponseHeader("gatewayCSRFToken")!==""){var h=g.getResponseHeader("gatewayCSRFToken");if(h!==""&&h!==undefined){jsonHeaderObj.gatewayCSRFToken=h}}if(g.getResponseHeader("Content-Type")==="text/html; charset=iso-8859-1"&&a.indexOf("signOff")===-1){popup("For your security, your banking session has timed out due to inactivity.","OK",150,200,signOff)}else{if(e!==undefined&&typeof e==="function"){var f=g.getResponseHeader("csrfToken");if(typeof f!=="undefined"&&f!==null){applicationObj.csrfSecurity={csrfToken:f}}e(c,g)}}}})}function makeServiceCallWithNetworkErrorHandled(a,b,e,d){var c="";if(typeof d=="undefined"){var d={};d.requestType=jsonServiceObj.requestType;d.endpoint=jsonServiceObj.endpoint;d.cache=jsonServiceObj.cache;d.retries=jsonServiceObj.retries;d.dataType=jsonServiceObj.dataType;d.async=jsonServiceObj.async;d.contentType=jsonServiceObj.contentType}if(loggingObj.logLevel>0){console.log("Endpoint: "+a+"\nPayload: "+b+"\nRequest: "+getObj(d,",","=")+"\nCookies: "+document.cookie+"\nHeaderObj: "+getObj(jsonHeaderObj,",","="));serviceText="Endpoint: "+a+"\nPayload: "+b+"\nRequest: "+getObj(d,",","=")+"\nCookies: "+document.cookie+"\nHeaderObj: "+getObj(jsonHeaderObj,",","=")}if(loggingObj.logLevel>1){console.log("GlobalObj: "+getObj(globalObj,",","="));serviceText+="GlobalObj: "+getObj(globalObj,",","=")}$.ajax({type:d.requestType,contentType:d.contentType,xhrFields:{withCredentials:true},cache:d.cache,headers:jsonHeaderObj,async:d.async,dataType:d.dataType,beforeSend:function(f){},url:a,data:b,success:function(f,h,g){c=f},error:function(h,g,f){c=false;if(h.readyState===0||h.readyState===1||h.readyState===2||h.readyState===3){c="network error"}if(h.status==401||h.status==404||h.status==405||h.status==406||h.status==410||h.status==412||h.status==415||h.status==417||h.status==503||h.status==504){if(mobilewebconfig.errorPath!==undefined&&mobilewebconfig.errorPath!==""){pageObj.touchEvent=true;window.location.hash=mobilewebconfig.errorPath}}},complete:function(g,i){if(loggingObj.logLevel>0&&typeof c==="object"){console.log("Response from "+a+": "+JSON.stringify(c));loggingObj.serviceText+="Response from "+a+": "+JSON.stringify(c)}if(g.getResponseHeader("gatewayCSRFToken")!==null&&g.getResponseHeader("gatewayCSRFToken")!==""){var h=g.getResponseHeader("gatewayCSRFToken");if(h!==""&&h!==undefined){jsonHeaderObj.gatewayCSRFToken=h}}if(g.getResponseHeader("Content-Type")==="text/html; charset=iso-8859-1"&&a.indexOf("signOff")===-1){popup("For your security, your banking session has timed out due to inactivity.","OK",150,200,signOff)}else{if(e!==undefined&&typeof e==="function"){var f=g.getResponseHeader("csrfToken");if(typeof f!=="undefined"&&f!==null){applicationObj.csrfSecurity={csrfToken:f}}e(c,g)}}}})}function postBusinessEvent(a,b,d){jsonHeaderObj.Accept="application/json";var c;if(typeof d=="undefined"){var d={};d.requestType=jsonServiceObj.requestType;d.contentType=jsonServiceObj.contentType;d.endpoint=jsonServiceObj.endpoint;d.cache=jsonServiceObj.cache;d.retries=jsonServiceObj.retries;d.dataType=jsonServiceObj.dataType;d.async=jsonServiceObj.async}if(loggingObj.logLevel>0){serviceText="Endpoint: "+a+"\nPayload: "+jsonData+"\nRequest: "+getObj(d,",","=")+"\nCookies: "+document.cookie+"\nHeaderObj: "+getObj(jsonHeaderObj,",","=")}if(loggingObj.logLevel>1){serviceText+="GlobalObj: "+getObj(globalObj,",","=")}$.ajax({type:d.requestType,contentType:d.contentType,xhrFields:{withCredentials:true},cache:d.cache,headers:jsonHeaderObj,async:d.async,dataType:d.dataType,beforeSend:function(e){var f=navigator.userAgent.toLowerCase();if(f.match(/msie/)){requestStartTime=msieISOString()}else{requestStartTime=new Date().toISOString()}},url:a,data:b,success:function(e,g,f){globalObj.isPingFailed=false;c=e;globalObj.nativeTimeOut=new Date().getTime()},error:function(g,f,e){hideLoading();console.log("Call "+a+" failed: rep = "+g.statusText+" ; ex = "+f+"; o = "+e);if(g.status===0||g.status==400||g.status==401||g.status==404||g.status==405||g.status==406||g.status==410||g.status==412||g.status==415||g.status==417||g.status==500||g.status==503||g.status==504){return g.status}c=false},complete:function(e,f){if(loggingObj.logLevel>0){loggingObj.serviceText+="Response from "+a+": "+JSON.stringify(c)}if(c===false&&e.responseText!==undefined){c=e.responseText}}});return c}function nativeServiceCallback(f,b,d,e,a,c){if(d===-1||d===401||d===404||d===405||d===406||d===410||d===412||d===415||d===417||d===500||d===503||d===504){window.location.hash=mobilewebconfig.errorPath}else{if(d===0){networkUnavailable()}else{globalObj.nativeTimeOut=new Date().getTime();setObj("headerObj",e,a,c);if(f!=="undefined"&&typeof f==="function"){f($.parseXML(b))}}}}function callbackService(f,d,h,b,a,c){var i=((a==="")?"":a.substring(1,a.indexOf(" ")));var g=new Date().toISOString();if(b!==null&&b!==""){if(headerObj.uniq_session_id===undefined){headerObj.uniq_session_id=""}if(headerObj.SMIDENTITY===undefined){headerObj.SMIDENTITY=""}if(h===undefined){h=""}var e="|"+i+"| - |"+headerObj.CRequestID+"| - |"+d+"| - |"+g+"| - |"+headerObj.CConnType+"| - |"+headerObj.CConnType+"| - |"+headerObj.CView+"| - |"+a.length+"| - |"+f.responseText.length+"| - |"+headerObj.uniq_session_id.substring(0,5)+"| - |"+headerObj.uniq_session_id.substring(0,5)+"| - |"+headerObj.SMIDENTITY.substring(0,5)+"| - |"+headerObj.SMIDENTITY.substring(0,5)+"| - |"+h.substring(0,5)+"| - |"+f.status+"| -|"+c+"|";if(b==="off"){headerObj.CallLog=""}else{if(b==="clear"){headerObj.CallLog=e;console.log(i+" headerObj CallLog : "+headerObj.CallLog)}}if(isSet(headerObj.CRequestID)){headerObj.CRequestID+=1}}}function extractCookiesFromResponse(b){if(b!==null&&b!==""){var d=b.split(";");for(var a=0;a<d.length;a++){if(d[a]!==null&&d[a]!==""){var c=d[a].split("=");if(c[0]!==null&&c[0]!==""){cookieObj[c[0]]=c[1]}}}}}function sanitizeXmlDataReq(b){var d=true;var a="";try{if(b!==""&&b!==null){a=$.parseXML(b)}else{d=true;sanitizedXML=""}}catch(c){console.log("Error in request "+c);d=false}return d}function validateResponse(c){var a=c;var b=$(c).contents().text().escapeResponseHtml();if((typeof c).toLowerCase()==="string"){return c.replace($(c).contents().text(),b)}else{return filterResponse(c)}}function getGlobals(){var b="";for(var a in globalObj){if(globalObj.hasOwnProperty(a)){b+=a+"="+globalObj[a]+"&"}}return b}function setGlobals(f){var e=f.split(",");for(var b=0;b<e.length;b++){var c=e[b].split("=");var a=c[0];var d=c[1];if(d==="true"){globalObj[a]=true}else{if(d==="false"){globalObj[a]=false}else{globalObj[a]=d}}}}function getStringObj(a){if((typeof a).toLowerCase()==="string"){a={}}return JSON.stringify(a)}function setStringObj(b,a){window[b]=JSON.parse(a);return window[b]}function getObj(d,a,c){if((typeof d).toLowerCase()==="string"){d={}}if(!a){a="&"}if(!c){c="="}var e="";for(var b in d){if(d.hasOwnProperty(b)){e+=b+c+d[b]+a}}return e}function setObj(c,f,a,e){if((typeof c).toLowerCase()==="string"){c={}}if(!a){a=","}if(!e){e="="}var b=f.split(a);for(var d=0;d<b.length;d++){var j=b[d].split(e);var h=j[0];var g=j[1];if(typeof g!=="undefined"){c[h]=g}}return c}function convertXMLtoJSON(a,b){if(typeof $.xml2json==="function"){b($.xml2json(a))}else{$.ajax({url:"js/libs/jquery.xml2json.js",dataType:"script",cache:true,complete:function(){b($.xml2json(a))}})}}function getLogs(){return loggingObj.logText+"\n"+loggingObj.appText+"\n"+loggingObj.pageText+"\n"+loggingObj.serviceText}function setHeaders(h,a,f){if(!a){a=","}if(!f){f="="}var g=h.split(a);for(var c=0;c<g.length;c++){var d=g[c].split(f);var b=d[0];var e=d[1];if(e==="true"){headerObj[b]=true}else{if(e==="false"){headerObj[b]=false}else{headerObj[b]=e}}}}function getStringXML(a){var b;if(window.ActiveXObject){b=a.xml}else{b=(new XMLSerializer()).serializeToString(a)}return b}function isSafeHeader(b){var c=true;var a=["Date","Via","Connection","Content-Length","Keep-Alive","Transfer-Encoding"];$.each(a,function(d,f){if(f.toLowerCase()===b.toLowerCase()){c=false}});return c}function loadNative(a){setViewPort();loadPages(a)}function setDeviceType(){var b=navigator.userAgent.toLowerCase();var a=b.match(/applewebkit\/([0-9]+)/);globalObj.webkitVersion=a&&a[1];if(b.match(/windows phone/)||b.match(/windows nt/)){globalObj.isWindows=true;globalObj.deviceType="Windows"}else{if(b.match(/webos/)){globalObj.deviceType="webOS"}else{if(b.match(/ipod/)){globalObj.isIphone=true;globalObj.deviceType="iPod"}else{if(b.match(/iphone/)){globalObj.isIphone=true;globalObj.deviceType="iPhone"}else{if(b.match(/ipad/)){globalObj.isIpad=true;globalObj.deviceType="iPad"}else{if(b.match(/blackberry/)){globalObj.deviceType="BlackBerry"}else{if(b.match(/android/)){globalObj.isAndroid=true;globalObj.deviceType="Android"}else{if(b.match(/symbian/)){globalObj.deviceType="Symbian"}else{if(b.match(/silk/)){globalObj.isKindle=true;globalObj.deviceType="Kindle"}else{globalObj.deviceType="Unknown"}}}}}}}}}}function isBlackBerry(){var b=navigator.userAgent;var a=b.match(/Version\/([0-9]+)/);if(b.indexOf("BB10")>-1&&a[1]>=10){return true}return false}function getDeviceType(){if(globalObj.deviceType===""){setDeviceType()}return globalObj.deviceType}function getAppVersion(){return jsonHeaderObj["x-crt-app-version"]}function setSessionVal(a){var d=a.split(",");var c="";for(var b=0;b<d.length;b++){if(d[b].indexOf("JS_VIPAAWS")>-1){c=d[b].split(";");tempstr1=c[0].substr(c[0].indexOf("=")+1,c[0].length);globalObj.vipaaSession.push(tempstr1)}}}function setSignonReponse(a){applicationObj.signOnResponse=a}function setPaymentReponse(a){applicationObj.outGoingPaymentList=a}function pingServer(c){var a=new cloneObj(jsonServiceObj);a.requestType="GET";endPoint=globalObj.env+"/mda/security/ping";var b="";makeServiceCall(endPoint,b,function(d){if(navigator.onLine==="false"||d===false){globalObj.isPingFailed=true}else{globalObj.isPingFailed=false}},a)}function setPing(){var a=1000*60*globalObj.pingTimer;setInterval(pingServer,a)}function setApplicationObj(){applicationObj={linkBack:"",allowPaging:"",navigation:false,signOnResponse:"",outGoingPaymentList:"",coreMetricsConfig:{CMPageIDVal:"",CMCatIDVal:""}}}function msieISOString(){function a(b){return b<10?"0"+b:b}date=new Date();return date.getUTCFullYear()+"-"+a(date.getUTCMonth()+1)+"-"+a(date.getUTCDate())+"T"+a(date.getUTCHours())+":"+a(date.getUTCMinutes())+":"+a(date.getUTCSeconds())+"Z"}function cmSetDD(){var b=window.location.href;if(b.toLowerCase().indexOf(".bankofamerica.com")>-1){b=b.toLowerCase();var c=b.split(".bankofamerica.com");var a=c[0];if(a.indexOf("//")>-1){c=a.split("//");a=c[1];if(a.indexOf(".")>-1){c=a.split(".");a=c[0];var d=c[1]}if(a.indexOf("www")>-1){if(a.indexOf("-")>-1){cmSetStaging()}else{if(d!=null){if(d.indexOf("ecnp")>-1){cmSetStaging()}}else{cmSetProduction()}}}else{if(a.indexOf("-")>-1){if(a.indexOf("sitekey")>-1){if(a=="sitekey"){cmSetProduction()}else{cmSetStaging()}}else{cmSetStaging()}}else{if(d!=null){if(d.indexOf("ecnp")>-1){cmSetStaging()}}else{cmSetProduction()}}}}}}if(typeof cmSetStaging=="function"){cmSetDD()}function BusinessEvent(h,g,f,c,d,b,a,e){this.provider=h;this.serviceCategory=g;this.code=f;this.adx=c;this.description=d;this.channelCode=b;this.statusCode=a;this.reasonCode=e;this.nameValuePairs=[]}function addNameValue(a,b,c){a.nameValuePairs.push({name:b,value:c});return a}BusinessEvent.prototype.addNameValue=function(a,b){return addNameValue(this,a,b)};function logBusinessEvent(c,a,d){var e=new cloneObj(serviceObj);e.requestType="POST";e.contentType="text/json";e.dataType="json";var b=JSON.stringify(c);b='{ "'+a+'": '+b+"}";if(d.indexOf("PIPAD-15010")<=-1){return makeServiceCall(globalObj.env+d,b,undefined,e)}else{return""}}(function(f){f.app=f.app||{};var g=null,a="chickeswitchxml";function d(i){var j={};$(i).find("featureEnableIndicator").each(function(k,l){l=$(l);j[l.attr("featureKey")]=l.attr("isEnabled")==="true"});return j}f.app.getFeatureSwitches=function(){var j,i;if(g!=null){return g}j=$.Deferred();g=j.promise();i=f.sessionStorage&&sessionStorage.getItem(a);if(i){j.resolve(d($.parseXML(i)))}else{makeServiceRequest(globalObj.env+"/mgateway/xservice/bootstrap/v1/4.1.012/MobileWeb?accept=xml","",function(k){if(k===false){j.reject(new Error("Service Error"))}else{j.resolve(d(k));if(f.sessionStorage){sessionStorage.setItem(a,new XMLSerializer().serializeToString(k))}}},$.extend({},serviceObj,{requestType:"GET"}))}return g};function c(i){return i.split("?").slice(1).join("?")}function b(i){return i.split("?")[0]}function h(j,i){return j&&i?j+"&"+i:j||i}var e=/^bofa:\/\//;f.app.mapLink=function(i){if(e.test(i)){var k=i.split("?")[0];var j=mobilewebconfig.splashLinks[k];if(j==null){throw"Could not map "+i}var l=h(c(j),c(i));if(l.length>0){l="?"+l}return b(j)+l}else{return i}}}(window));function getAkamaiPodType(){if(globalObj.akamaiPodType===""){}return globalObj.akamaiPodType}function isPilot(a,b){var c=false;if(globalObj.isUserAuthenticated&&isSet(globalObj.moduleParameters)){$.each(globalObj.moduleParameters,function(d){moduleName=globalObj.moduleParameters[d].module;if(moduleName===a){name=globalObj.moduleParameters[d].name;if(name===b){c=globalObj.moduleParameters[d].indicator}}})}return c}function spartaBondFlag(){var b="";applicationObj.spartaBond=false;var c=new DOMParser().parseFromString(sessionStorage.getItem("chickeswitchxml"),"text/xml");globalObj.chickenSwitches=$(c).find("featureEnableIndicator");var a=globalObj.chickenSwitches;if(isSet(a)&&a.length>0){jQuery.each(a,function(d,e){var f=$(e).attr("featureKey");if(f==="featureSwitch_SpartaBond"){b=$(e).attr("isEnabled");if(b==="true"||b==="TRUE"){applicationObj.spartaBond=true}else{applicationObj.spartaBond=false}return false}else{applicationObj.spartaBond=false}})}}function loadSpartaPages(){applicationObj.isSpartaRedirect=false;applicationObj.spartaRedirectUrl="";if(window.location.href.indexOf("creditscore")>-1){if(isPilot("CreditScore","creditScoreSparta-pilot")){var c=false;var a=false;if(applicationObj.signOnResponse.payload&&applicationObj.signOnResponse.payload.customer&&applicationObj.signOnResponse.payload.customer.eligibilityProfile&&applicationObj.signOnResponse.payload.customer.eligibilityProfile.creditScoreEnrollmentEligibility=="Y"){c=true}if(c){var b=applicationObj.signOnResponse.payload.services;$.each(b,function(e,d){if(isSet(d.identifier)&&isSet(d.identifier.productCode)&&d.identifier.productCode=="CCS"&&isSet(d.status)&&d.status=="EFFECTIVE"&&c===true){a=true}else{if(isSet(d.identifier)&&isSet(d.identifier.productCode)&&d.identifier.productCode=="CCS"&&isSet(d.status)&&d.status!=="EFFECTIVE"&&c===true){a=false}}});if(a){applicationObj.isSpartaRedirect=true;applicationObj.spartaRedirectUrl=globalObj.spartaRedirectionURI+"myaccounts/brain/redirect.go?target=creditscore"}else{applicationObj.isSpartaRedirect=true;applicationObj.spartaRedirectUrl=globalObj.spartaRedirectionURI+"myaccounts/brain/redirect.go?target=enrollcreditscore"}}}}};